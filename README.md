# Торговый центр "Кристалл" - Административная панель

## Требования

- Node.js (версия 14 или выше)
- MySQL (версия 5.7 или выше)
- npm (входит в состав Node.js)

## Установка и настройка

1. Клонируйте репозиторий:
```bash
git clone <url-репозитория>
cd mall
```

2. Установите зависимости:
```bash
npm install
```

3. Создайте файл `.env` в корневой директории проекта и настройте переменные окружения:
```env
# Настройки базы данных
DB_HOST=localhost
DB_USER=ваш_пользователь
DB_PASS=ваш_пароль
DB_NAME=mall_db

# Настройки сервера
PORT=3000
NODE_ENV=development

# Секретный ключ для сессий
SESSION_SECRET=ваш_секретный_ключ
```

4. Создайте базу данных:
```bash
mysql -u root -p
CREATE DATABASE mall_db;
```

5. Запустите миграции для создания таблиц:
```bash
npx sequelize-cli db:migrate
```

6. (Опционально) Заполните базу тестовыми данными:
```bash
npx sequelize-cli db:seed:all
```

## Запуск приложения

1. Для разработки:
```bash
npm run dev
```

2. Для продакшена:
```bash
npm start
```

Приложение будет доступно по адресу: http://localhost:3000

## Административная панель

Для доступа к административной панели перейдите по адресу: http://localhost:3000/admin

### Основные функции административной панели:

1. **Управление магазинами**
   - Создание нового магазина: `/admin/shops/create`
   - Поля для заполнения:
     - Название магазина (обязательно)
     - Категория (обязательно)
     - Этаж (обязательно)
     - Описание
     - Часы работы
     - Телефон
     - URL изображения

2. **Управление событиями**
   - Создание нового события: `/admin/events/create`
   - Поля для заполнения:
     - Название события (обязательно)
     - Описание
     - Дата (обязательно)
     - Время
     - Место проведения
     - URL изображения

3. **Управление акциями**
   - Создание новой акции: `/admin/promotions/create`
   - Поля для заполнения:
     - Название акции (обязательно)
     - Описание
     - Магазин (обязательно)
     - Дата начала (обязательно)
     - Дата окончания (обязательно)
     - Размер скидки (%)
     - URL изображения

4. **Управление фильмами**
   - Создание нового фильма: `/admin/movies/create`
   - Поля для заполнения:
     - Название фильма (обязательно)
     - Описание
     - Продолжительность (минут) (обязательно)
     - Жанр (обязательно)
     - Режиссер
     - Актеры
     - Дата выхода (обязательно)
     - Возрастное ограничение (обязательно)
     - URL постера
     - URL трейлера
     - Статус активности

## Структура проекта

```
mall/
├── src/
│   ├── config/         # Конфигурационные файлы
│   ├── controllers/    # Контроллеры
│   ├── middleware/     # Промежуточное ПО
│   ├── models/         # Модели Sequelize
│   └── routes/         # Маршруты
├── views/
│   ├── pages/          # Страницы
│   └── partials/       # Повторно используемые компоненты
├── public/             # Статические файлы
└── .env               # Переменные окружения
```

## Разработка

### Добавление новых функций

1. Создайте новую модель:
```bash
npx sequelize-cli model:generate --name ModelName --attributes field:type
```

2. Создайте новую миграцию:
```bash
npx sequelize-cli migration:generate --name migration-name
```

3. Добавьте маршруты в `src/routes/web/index.js`

4. Создайте представления в директории `views/pages/`

### Стилизация

- Все стили находятся в соответствующих `.ejs` файлах
- Используются CSS-переменные для единообразия оформления
- Основные цвета и размеры определены в корневых стилях

## Поддержка

При возникновении проблем:

1. Проверьте логи в консоли
2. Убедитесь, что все переменные окружения настроены правильно
3. Проверьте подключение к базе данных
4. Убедитесь, что все зависимости установлены корректно